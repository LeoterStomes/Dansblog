---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';

type Props = CollectionEntry<'blog'>['data'] & {
	profileImage?: string;
};

const { title, description, pubDate, updatedDate, heroImage, profileImage } = Astro.props;
---

<html lang="en">
	<head>
		<BaseHead title={title} description={description} />
	</head>
	<body>
		<Header />
		<main class="page-shell py-10 md:py-14" transition:name="page-main" transition:animate="fade">
			<article class="section-enter mx-auto max-w-3xl">
				{heroImage && (
					<div class="mb-8 overflow-hidden rounded-2xl border border-zinc-200 bg-white dark:border-zinc-700 dark:bg-zinc-900">
						{
							typeof heroImage === 'string' ? (
								<img src={heroImage} alt={title} class="h-auto w-full" loading="lazy" />
							) : (
								<Image width={1200} height={620} src={heroImage} alt="" class="h-auto w-full" />
							)
						}
					</div>
				)}
				<header class="mb-8 border-b border-zinc-200 pb-6 dark:border-zinc-700">
					<p class="m-0 text-sm text-zinc-500 dark:text-zinc-400">
						<FormattedDate date={pubDate} />
						{
							updatedDate && (
								<span class="ml-3 inline-block italic">
									Updated <FormattedDate date={updatedDate} />
								</span>
							)
						}
					</p>
					<div class="mt-3 flex items-start justify-between gap-4">
						<h1 class="text-3xl font-semibold tracking-tight text-zinc-900 dark:text-zinc-100 md:text-4xl" transition:name="page-title" transition:animate="fade">
							{title}
						</h1>
						{
							profileImage && (
								<img
									src={profileImage}
									alt={`${title} profile`}
									class="h-14 w-14 shrink-0 rounded-full border border-zinc-200 object-cover dark:border-zinc-700 md:h-16 md:w-16"
									loading="lazy"
								/>
							)
						}
					</div>
					<p class="mt-3 font-serif text-zinc-600 dark:text-zinc-300">{description}</p>
				</header>
				<div class="markdown-prose">
					<slot />
				</div>
			</article>
		</main>
		<Footer />
	</body>
</html>
